@prefix aime:   <https://w3id.org/agri-image/ontology-extension#> .
@prefix dcat:   <http://www.w3.org/ns/dcat#> .
@prefix dcterms:<http://purl.org/dc/terms/> .
@prefix exif:   <http://ns.adobe.com/exif/1.0/> .
@prefix owl:    <http://www.w3.org/2002/07/owl#> .
@prefix prov:   <http://www.w3.org/ns/prov#> .
@prefix qudt:   <http://qudt.org/schema/qudt/> .
@prefix rdf:    <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix schema: <https://schema.org/> .
@prefix sh:     <http://www.w3.org/ns/shacl#> .
@prefix unit:   <http://qudt.org/vocab/unit/> .
@prefix xsd:    <http://www.w3.org/2001/XMLSchema#> .

<https://w3id.org/agri-image/application-profile/metadata-profile> a owl:Ontology ;
  dcterms:title "Agriculture Image Metadata â€“ Application Profile (SHACL)"@en ;
  dcterms:description "SHACL shapes derived from dataset_package_schema.json.txt; maps fields to existing ontologies where possible and uses the local ontology extension for gaps."@en ;
  dcterms:license <https://creativecommons.org/licenses/by/4.0/> ;
  dcterms:conformsTo <http://www.w3.org/TR/shacl/> ;
  dcterms:created "2026-02-17"^^xsd:date ;
  owl:imports <https://w3id.org/agri-image/ontology-extension> .

#####################################################################
# SHACL shapes for DatasetPackage schema
#####################################################################

##############################
# DatasetPackage (top-level)
##############################

aime:DatasetPackageShape
  a sh:NodeShape ;
  sh:targetClass aime:DatasetPackage ;
  sh:property [
    sh:name "dataset" ;
    sh:path aime:dataset ;
    sh:class dcat:Dataset ;
    sh:minCount 1 ;
    sh:maxCount 1 ;
  ] ;
  sh:property [
    sh:name "fields" ;
    sh:path aime:fields ;
    sh:class aime:Field ;
    sh:minCount 1 ;
  ] ;
  sh:property [
    sh:name "machines" ;
    sh:path aime:machines ;
    sh:class aime:Machine ;
    sh:minCount 1 ;
  ] ;
  sh:property [
    sh:name "images" ;
    sh:path aime:images ;
    sh:class aime:Image ;
  ] .

##############################
# Dataset metadata (DCAT/DCTERMS)
##############################

aime:DatasetShape
  a sh:NodeShape ;
  sh:targetClass dcat:Dataset ;
  sh:property [
    sh:name "title" ;
    sh:path dcterms:title ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
  ] ;
  sh:property [
    sh:name "description" ;
    sh:path dcterms:description ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
  ] ;
  sh:property [
    sh:name "identifier" ;
    sh:path dcterms:identifier ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
  ] ;
  sh:property [
    sh:name "creator" ;
    sh:path dcterms:creator ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
  ] ;
  sh:property [
    sh:name "contributor" ;
    sh:path dcterms:contributor ;
    sh:datatype xsd:string ;
  ] ;
  sh:property [
    sh:name "accessURL" ;
    sh:path dcat:accessURL ;
    sh:datatype xsd:string ;
  ] ;
  sh:property [
    sh:name "version" ;
    sh:path dcat:version ;
    sh:datatype xsd:string ;
  ] ;
  sh:property [
    sh:name "issued" ;
    sh:path dcterms:issued ;
    sh:datatype xsd:string ;
  ] ;
  sh:property [
    sh:name "modified" ;
    sh:path dcterms:modified ;
    sh:datatype xsd:string ;
  ] ;
  sh:property [
    sh:name "startDate" ;
    sh:path dcat:startDate ;
    sh:datatype xsd:string ;
  ] ;
  sh:property [
    sh:name "endDate" ;
    sh:path dcat:endDate ;
    sh:datatype xsd:string ;
  ] ;
  sh:property [
    sh:name "license" ;
    sh:path dcterms:license ;
    sh:datatype xsd:string ;
  ] ;
  sh:property [
    sh:name "ID" ;
    sh:path aime:ID ;
    sh:datatype xsd:string ;
    sh:description "Internal UUID for the dataset (as in the JSON schema)."@en ;
  ] ;
  sh:property [
    sh:name "numberOfImages" ;
    sh:path aime:numberOfImages ;
    sh:datatype xsd:integer ;
  ] ;
  sh:property [
    sh:name "numberOfAnnotatedImages" ;
    sh:path aime:numberOfAnnotatedImages ;
    sh:datatype xsd:integer ;
  ] .

##############################
# Field
##############################

aime:FieldShape
  a sh:NodeShape ;
  sh:targetClass aime:Field ;
  sh:property [
    sh:name "fieldName" ;
    sh:path aime:fieldName ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
  ] ;
  sh:property [
    sh:name "fieldID" ;
    sh:path aime:fieldID ;
    sh:datatype xsd:string ;
  ] ;
  sh:property [
    sh:name "plots" ;
    sh:path aime:plots ;
    sh:nodeKind sh:BlankNodeOrIRI ;
    sh:description "Plot objects are not fully specified in dataset_package_schema.json.txt (items schema is empty). Use aime:Plot as a placeholder class."@en ;
  ] .

##############################
# Machine
##############################

aime:MachineShape
  a sh:NodeShape ;
  sh:targetClass aime:Machine ;
  sh:property [
    sh:name "machineName" ;
    sh:path aime:machineName ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
  ] ;
  sh:property [
    sh:name "machineID" ;
    sh:path aime:machineID ;
    sh:datatype xsd:string ;
  ] ;
  sh:property [
    sh:name "sensors" ;
    sh:path aime:sensors ;
    sh:class aime:Camera ;
  ] .

##############################
# Camera / sensor
##############################

aime:CameraShape
  a sh:NodeShape ;
  sh:targetClass aime:Camera ;
  sh:property [
    sh:name "cameraName" ;
    sh:path aime:cameraName ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
  ] ;
  sh:property [
    sh:name "cameraID" ;
    sh:path exif:SerialNumber ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
  ] ;
  sh:property [
    sh:name "cameraModel" ;
    sh:path exif:Model ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
  ] ;
  sh:property [
    sh:name "cameraLensModel" ;
    sh:path exif:LensModel ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
  ] ;
  sh:property [
    sh:name "maxPixelX" ;
    sh:path exif:PixelXDimension ;
    sh:datatype xsd:integer ;
    sh:minCount 1 ;
  ] ;
  sh:property [
    sh:name "maxPixelY" ;
    sh:path exif:PixelYDimension ;
    sh:datatype xsd:integer ;
    sh:minCount 1 ;
  ] ;
  sh:property [
    sh:name "pixelSize" ;
    sh:path aime:pixelSize ;
    sh:datatype xsd:decimal ;
    sh:minCount 1 ;
    qudt:unit unit:MicroM ;
  ] ;
  sh:property [
    sh:name "focalLength" ;
    sh:path exif:FocalLength ;
    sh:datatype xsd:decimal ;
    sh:minCount 1 ;
    qudt:unit unit:MilliM ;
  ] ;
  sh:property [
    sh:name "subjectDistance" ;
    sh:path exif:SubjectDistance ;
    sh:datatype xsd:decimal ;
    sh:minCount 1 ;
    qudt:unit unit:M ;
  ] ;
  sh:property [
    sh:name "spectralBand" ;
    sh:path aime:spectralBand ;
    sh:datatype xsd:string ;
    sh:in ( "rgb" "nir" "mono" "thermal" "multispectral" "depth" ) ;
  ] ;
  sh:property [
    sh:name "cameraBox" ;
    sh:path aime:cameraBox ;
    sh:datatype xsd:boolean ;
  ] ;
  sh:property [
    sh:name "lightSource" ;
    sh:path exif:LightSource ;
    sh:datatype xsd:integer ;
    sh:in ( 0 1 2 3 4 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 255 ) ;
  ] ;
  sh:property [
    sh:name "lightModel" ;
    sh:path aime:lightModel ;
    sh:datatype xsd:string ;
  ] ;
  sh:property [
    sh:name "intrinsics" ;
    sh:path aime:intrinsics ;
    sh:datatype rdf:JSON ;
    sh:description "Camera intrinsics (3x3 matrix) as JSON literal, per OpenCV calibration conventions."@en ;
  ] ;
  sh:property [
    sh:name "distortionModel" ;
    sh:path aime:distortionModel ;
    sh:datatype xsd:string ;
  ] ;
  sh:property [
    sh:name "distortionCoefficients" ;
    sh:path aime:distortionCoefficients ;
    sh:datatype rdf:JSON ;
  ] .

##############################
# Image
##############################

aime:ImageShape
  a sh:NodeShape ;
  sh:targetClass aime:Image ;
  sh:property [
    sh:name "imageName" ;
    sh:path aime:imageName ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
  ] ;
  sh:property [
    sh:name "imageTimestamp" ;
    sh:path aime:imageTimestamp ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
  ] ;
  sh:property [
    sh:name "imageID" ;
    sh:path aime:imageID ;
    sh:datatype xsd:string ;
  ] ;
  sh:property [
    sh:name "cameraID" ;
    sh:path aime:cameraID ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
  ] ;
  sh:property [
    sh:name "fieldID" ;
    sh:path aime:fieldID ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
  ] ;
  sh:property [
    sh:name "plotID" ;
    sh:path aime:plotID ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
  ] ;
  sh:property [
    sh:name "machineID" ;
    sh:path aime:machineIDRef ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
  ] ;
  sh:property [
    sh:name "exposureTime" ;
    sh:path exif:ExposureTime ;
    sh:datatype xsd:decimal ;
    qudt:unit unit:SEC ;
  ] ;
  sh:property [
    sh:name "imageNumber" ;
    sh:path exif:ImageNumber ;
    sh:datatype xsd:integer ;
  ] ;
  sh:property [
    sh:name "imageXYZ" ;
    sh:path aime:imageXYZ ;
    sh:datatype xsd:decimal ;
    sh:minCount 0 ;
    sh:maxCount 3 ;
    qudt:unit unit:M ;
    sh:description "Camera location XYZ (3 values) relative to base."@en ;
  ] ;
  sh:property [
    sh:name "imageQuaternionXYZW" ;
    sh:path aime:imageQuaternionXYZW ;
    sh:datatype xsd:decimal ;
    sh:maxCount 4 ;
    sh:description "Camera orientation quaternion [x,y,z,w] (4 values) relative to base."@en ;
  ] ;
  sh:property [
    sh:name "imageGNSS" ;
    sh:path aime:imageGNSS ;
    sh:datatype xsd:string ;
    sh:description "NMEA GNSS string of camera position."@en ;
  ] ;
  sh:property [
    sh:name "baseXYZ" ;
    sh:path aime:baseXYZ ;
    sh:datatype xsd:decimal ;
    sh:minCount 3 ;
    sh:maxCount 3 ;
    qudt:unit unit:M ;
    sh:description "Machine base location XYZ (3 values) in global frame."@en ;
  ] ;
  sh:property [
    sh:name "baseQuaternionXYZW" ;
    sh:path aime:baseQuaternionXYZW ;
    sh:datatype xsd:decimal ;
    sh:minCount 4 ;
    sh:maxCount 4 ;
    sh:description "Machine base orientation quaternion [x,y,z,w] (4 values) in global frame."@en ;
  ] ;
  sh:property [
    sh:name "baseGNSS" ;
    sh:path aime:baseGNSS ;
    sh:datatype xsd:string ;
    sh:description "NMEA GNSS string of machine base position."@en ;
  ] .


